# Localization Setup

This document explains the localization (i18n) setup for the portfolio website.

## Overview

- **Languages**: English (EN) as default, Turkish (TR) as secondary
- **Routing**: `/` for EN, `/tr` for TR
- **Framework**: Paraglide.js with SvelteKit integration

## File Structure

```
src/
├── lib/
│   ├── i18n.ts                 # Paraglide configuration
│   ├── i18n-utils.ts           # Common i18n utilities
│   ├── blog-utils.ts           # Blog post utilities with caching
│   └── paraglide/              # Auto-generated by Paraglide
├── content/
│   ├── en.json                 # English UI messages
│   ├── tr.json                 # Turkish UI messages
│   ├── projects.ts             # English projects
│   ├── projects-tr.ts          # Turkish projects
│   ├── skills.ts               # English skills
│   ├── skills-tr.ts            # Turkish skills
│   ├── contact.ts              # Contact info (language-agnostic)
│   ├── index.ts                # Content helpers
│   └── blog/posts/             # Blog posts with id & lang fields
└── routes/
    ├── +layout.svelte          # Root layout with hreflang
    └── blog/
        ├── +page.server.ts     # Blog listing
        └── [slug]/
            ├── +page.ts        # Post loader with auto-redirect
            ├── +page.svelte    # Post page with hreflang
            └── +error.svelte   # 404 error page
```

## Key Features

### 1. Shared Utilities (`i18n-utils.ts`)

Central utilities for language detection and path building:

- `getLanguageFromPath(pathname)` - Detects language from URL
- `buildLocalizedPath(path, lang)` - Builds localized URLs
- `isBlogPostPath(pathname)` - Checks if path is a blog post

### 2. Blog Post Caching

`getAllPosts()` caches results to avoid multiple file system reads during a single request.

### 3. Smart URL Generation

`getPostAlternates()` now returns both post objects and localized URLs, eliminating duplicate URL building logic.

### 4. Automatic Redirects

When accessing a post with the wrong language's slug, the system automatically redirects to the correct slug for the current language.

### 5. SEO-Friendly hreflang Tags

- **Most pages**: hreflang tags from root layout
- **Blog posts**: Custom hreflang tags with language-specific slugs
- **Automatic generation disabled**: Paraglide's automatic hreflang is disabled to prevent duplicates

## Usage

### UI Messages

```svelte
<script>
  import * as m from '$lib/paraglide/messages.js';
</script>

<h1>{m.hero_title()}</h1>
<p>{@html m.hero_description()}</p>
```

### Content (Projects/Skills)

```svelte
<script>
  import { getProjects, getSkills } from '$content';

  const projects = getProjects(); // Automatically returns correct language
  const skills = getSkills();
</script>
```

### Blog Posts

Blog posts require:
- `id`: Unique identifier linking translations
- `lang`: 'en' or 'tr'
- Different slugs for each language

Example frontmatter:

```yaml
---
id: 'how-we-see-what-we-look-for'
lang: 'en'
title: 'What my dining table showed me'
# ... other fields
---
```

## Language Switcher

The language switcher uses Paraglide's routing to switch languages while preserving the current route. Blog posts automatically redirect to the correct slug when switching languages.

## Adding New Content

### UI Text

1. Add keys to both `src/content/en.json` and `src/content/tr.json`
2. Use flat keys with prefixes: `section_key` (e.g., `hero_title`, `nav_blog`)
3. Import and use: `m.section_key()`

### Structured Content (Projects/Skills)

1. Update `src/content/projects.ts` and `src/content/projects-tr.ts`
2. Use helper: `getProjects()` or `getSkills()`

### Blog Posts

1. Create markdown file with unique slug
2. Add `id` and `lang` to frontmatter
3. For translations, use same `id`, different `slug` and `lang`

## Configuration

### Paraglide (`src/lib/i18n.ts`)

```typescript
export const i18n = createI18n(runtime, {
  defaultLanguageTag: 'en',
  prefixDefaultLanguage: 'never',
  seo: {
    noAlternateLinks: true // Disable automatic hreflang
  },
  pathnames: {
    '/blog': { en: '/blog', tr: '/blog' }
  }
});
```

### Project Settings (`project.inlang/settings.json`)

```json
{
  "sourceLanguageTag": "en",
  "languageTags": ["en", "tr"],
  "plugin.inlang.messageFormat": {
    "pathPattern": "./src/content/{languageTag}.json"
  }
}
```

## Best Practices

1. **Always use utilities**: Use `getLanguageFromPath()` instead of inline checks
2. **Cache awareness**: `getAllPosts()` is cached per request
3. **Consistent naming**: Use `section_key` format for message keys
4. **Link posts by ID**: Always use the same `id` for post translations
5. **Test both languages**: Verify all content works in both EN and TR

## Troubleshooting

### Duplicate hreflang tags
- Ensure `noAlternateLinks: true` in i18n config
- Check that blog posts don't overlap with root layout logic

### Wrong language content
- Verify `lang` field in frontmatter
- Check that content files use correct language suffix (-tr)

### Redirect loops
- Ensure post IDs match across languages
- Verify slugs are different for each language version

### Missing translations
- Check both message files have the same keys
- Run Paraglide's compile command to regenerate

